.m-legend {
  $btn-border: $light-grey;
  $default-icon-bg: $color-2;

  position: absolute;
  left: $dashboard-width + rem(20px);
  bottom: rem($margin-medium);
  z-index: 1;
  text-align: center;
  display: none;

  &.show {
    display: block;
  }

  .is-timeline-active & {
    bottom: rem(85px);
  }

  .legend-button {
    border: 1px solid $btn-border;
    background-color: $white;

    span {
      width: auto;
      text-transform: capitalize;
      font-weight: 800;
      font-size: rem($font-size);
      line-height: rem($font-size);
      letter-spacing: rem(0.65px);
      padding: 10px 12px 8px 12px;
      color: $font-color-1;
      display: inline-block;
      cursor: pointer;
      user-select: none;

      &:before {
        content: "";
        width: rem(12px);
        height: rem(12px);
        position: relative;
        display: inline-block;
        margin-right: rem(8px);
        background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sbnM6c2tldGNoPSJodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2gvbnMiPiAgICAgICAgPHRpdGxlPlJlY3RhbmdsZSA0NzcgKyBSZWN0YW5nbGUgNDc3IENvcHkgMiArIFJlY3RhbmdsZSA0ODE8L3RpdGxlPiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4gICAgPGRlZnM+PC9kZWZzPiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBza2V0Y2g6dHlwZT0iTVNQYWdlIj4gICAgICAgIDxnIGlkPSJTdGFydCIgc2tldGNoOnR5cGU9Ik1TQXJ0Ym9hcmRHcm91cCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTExNjUuMDAwMDAwLCAtNzkyLjAwMDAwMCkiIGZpbGw9IiM0NzQ0NDQiPiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0rLUdyb3VwLUNvcHktMiIgc2tldGNoOnR5cGU9Ik1TTGF5ZXJHcm91cCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTE1Mi4wMDAwMDAsIDc2LjAwMDAwMCkiPiAgICAgICAgICAgICAgICA8ZyBpZD0iR3JvdXAtQ29weS0yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgNzA0LjAwMDAwMCkiIHNrZXRjaDp0eXBlPSJNU1NoYXBlR3JvdXAiPiAgICAgICAgICAgICAgICAgICAgPGcgaWQ9IlJlY3RhbmdsZS00NzctKy1SZWN0YW5nbGUtNDc3LUNvcHktMi0rLVJlY3RhbmdsZS00ODEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzLjAwMDAwMCwgMTIuMDAwMDAwKSI+ICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTgsMyBMMTAsMyBMMTAsMTAgTDMsMTAgTDMsOCBMMSw4IEwxLDEgTDgsMSBMOCwzIFogTTEsMSBMMTIsMSBMMTIsMTIgTDEsMTIgTDEsMSBaIiBpZD0iUmVjdGFuZ2xlLTQ3NyI+PC9wYXRoPiAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik02LDIgTDIsMiBMMiw2IEwwLDYgTDAsMCBMNiwwIEw2LDIgWiIgaWQ9IlJlY3RhbmdsZS00NzctQ29weS0yIj48L3BhdGg+ICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTIuNTk4MzQ5NTcsMC40NTE5MDI5NjEgTDQuODA1NDU2MzUsMC40NTE5MDI5NjEgTDQuODA1NDU2MzUsNi45NTE5MDI5NiBMMi41OTgzNDk1Nyw2Ljk1MTkwMjk2IEwyLjU5ODM0OTU3LDAuNDUxOTAyOTYxIFoiIGlkPSJSZWN0YW5nbGUtNDgxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzLjcwMTkwMywgMy43MDE5MDMpIHJvdGF0ZSgtNDUuMDAwMDAwKSB0cmFuc2xhdGUoLTMuNzAxOTAzLCAtMy43MDE5MDMpICI+PC9wYXRoPiAgICAgICAgICAgICAgICAgICAgPC9nPiAgICAgICAgICAgICAgICA8L2c+ICAgICAgICAgICAgPC9nPiAgICAgICAgPC9nPiAgICA8L2c+PC9zdmc+);
      }
    }
  }

  .legend-box {
    display: none;
    width: rem(260px);
    height: rem(280px);
    background: $white;
    box-shadow: 0px 0px 0px 1px rgba(0,0,0,0.10), 0px 2px 10px 0px rgba(0,0,0,0.15);
    overflow: hidden;

    .legend-top {
      width: 100%;
      padding: 14px 10px 0 18px;
      text-align: left;
      display: inline-block;
      position: relative;
      font-size: rem($font-size);
      font-weight: 800;
      text-transform: capitalize;
      letter-spacing: rem(0.65px);
      color: $font-color-1;

      .legend-title {
        width: 80%;
        float: left;
        color: $color-1;
      }

      .legend-btn-close {
        @extend %btn-close;
        display: inline-block;
        float: right;
        width: 20px;
        height: rem(24px);
        font-size: 15px;
      }
    }

    .legend-content {
      width: 100%;
      height: rem(230px);
      padding: 0 10px 10px 18px;
      overflow-y: scroll;
      overflow-x: hidden;
    }

    .group {
      text-align: left;
      margin-bottom: rem(10px);

      .group-name {
        width: 100%;
        font-size: rem($font-size);
        font-weight: 700;
        color: $font-color-1;
        margin-bottom: rem(5px);
      }

      .group-items {
        .group-item {
          width: 100%;
          font-size: rem($font-size);
          font-weight: 500;
          color: $font-color-1;
          margin-bottom: rem(3px);

          .item-icon {
            display: inline-block;
            width: rem(8px);
            height: rem(8px);
            border-radius: rem(8px);
            background: $default-icon-bg;
            margin-right: rem(5px);
            margin-bottom: rem(1px);
            background-color: $soft-grey !important;
          }
        }
      }
    }

    .legend-item {
      margin-bottom: $margin-medium;
    }
  }

  &.legend-visible {
    bottom: 0;

    .is-timeline-active & {
      bottom: rem(49px);
    }

    .legend-button {
      display: none;
    }

    .legend-box {
      display: block;
    }
  }

}

.cartodb-logo {
  bottom: 1.25rem !important;
  left: 150px !important;
}

.cartodb-legend {
  &.custom,
  &.choropleth {
    position: relative;
    top: 0;
    right: 0;
    left: 0;
    bottom: 0;
    box-shadow: none;
    border: 0;
    padding: 5px 5px 0px 0px !important;
  }
}

div.cartodb-legend.custom ul li .bullet {
  width: 20px;
  height: 10px;
  border-radius: 0;
  border: 0;
}
